<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Title</title>
</head>
<body>
    <!--Menu encabezado-->
    <div th:replace="~{layout/layout :: nav_bar}" ></div>

    <!--Seccion Crear-->
    <section class="bg-black min-h-screen flex items-center justify-center">
        <div class="bg-gray-100 flex rounded-2xl shadow-lg max-w-3xl p-5 items-center mt-[120px]">
            <div class="sm:block hidden w-[1000px]">
                <img class="rounded-2xl" th:src="@{/images/obra_banner.JPG}" alt="No carga">
            </div>
            <div class="sm:w-1/2 px-16">
                <h2 class="font-bold text-2xl text-black">[[${title}]]</h2>
                <form th:object="${obra}"
                      th:action="@{crearObra}"
                      method="post" enctype="multipart/form-data" class="flex flex-col gap-4">
                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-4" for="tituloO">*Titulo Obra:</label>
                    <input class="p-2 border-2 border-black-500 rounded-xl" type="text" name="tituloO" id="tituloO" placeholder="Noche estrellada" th:field="*{tituloObra}" maxlength="70" required="true"/>

                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-2" for="clasificacionObra">*Seleccionar clasificación:</label>
                    <select class="bg-transparent py-1 border-b border-sky-900 focus:border-sky-200 transition-all focus:scale-105 focus:font-normal"
                            id="clasificacionObra" name="clasificacionObra" onchange="actualizarDimensiones()">
                        <option value="" th:text="'--Seleccione--'" disabled selected></option>
                        <option value="pintura" th:text="'Pintura'" th:selected="${obra.clasificacionObra == 'pintura'}"></option>
                        <option value="dibujo" th:text="'Dibujo'" th:selected="${obra.clasificacionObra == 'dibujo'}"></option>
                        <option value="fotografia" th:text="'Fotografía'" th:selected="${obra.clasificacionObra == 'fotografia'}"></option>
                    </select>

                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-2" for="descripcionO">*Descripción:</label>
                    <textarea style="resize: none" class="p-2 border-2 border-black-500 rounded-xl" name="descripcionO" id="descripcionO" placeholder="vista nocturna mediante la técnica del impasto, mostrando un paisaje nocturno vibrante e inquietante." th:field="*{descripcionObra}" maxlength="100000" required="true"></textarea>


                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-2" for="anoCreacion">*Año de lanzamiento:</label>
                    <input class="p-2 border-2 border-black-500 rounded-xl" type="number" name="anoCreacion" id="anoCreacion" min="1960" max="2024" th:field="*{anoCreacion}" required="true"/>

                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-2" for="dimensionesObra">*Seleccionar dimensiones:</label>
                    <select class="bg-transparent py-1 border-b border-sky-900 focus:border-sky-200 transition-all focus:scale-105 focus:font-normal"
                            id="dimensionesObra" name="dimensionesObra">
                        <option value="" th:text="'--Seleccione--'" disabled selected></option>
                        <option value="30x40" class="pintura dibujo fotografia">30x40 cm</option>
                        <option value="50x70" class="pintura dibujo fotografia">50x70 cm</option>
                        <option value="60x30" class="pintura">60x30 cm</option>
                        <option value="60x80" class="pintura">60x80 cm</option>
                        <option value="100x120" class="pintura">100x120 cm</option>
                        <option value="21x29.7" class="dibujo fotografia">21x29.7 cm</option>
                        <option value="29.7x42" class="dibujo fotografia">29.7x42 cm</option>
                        <option value="42x59.4" class="dibujo">42x59.4 cm</option>
                        <option value="25x15" class="dibujo">25x15 cm</option>
                        <option value="30x30x30" class="dibujo">30x30x30 cm</option>
                        <option value="50x70" class="fotografia">50x70 cm</option>
                        <option value="61x91" class="fotografia">61x91 cm</option>
                    </select>

                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-2" for="artista">*Seleccionar artista:</label>
                    <select id="artista" th:field="*{idArtista}" required name="artistas" class="bg-transparent py-1 border-b border-sky-900 focus:border-sky-200 transition-all focus:scale-105 focus:font-normal">
                        <option value="" th:text="'--Seleccione--'" disabled selected></option>
                        <option th:each="artista : ${artistas}"
                                th:value="${artista.idArtista}"
                                th:text="${artista.nombreArt} + ' - ' + ${artista.apellidoArt}">
                        </option>
                    </select>


                    <label style="font-size: 15px; font-family: 'Righteous', serif;" class="mt-2" for="foto">*Foto obra:</label>
                    <input class="p-2 border-2 border-black-500 rounded-xl" type="file" name="foto" id="foto" placeholder="Archivo de... "  maxlength="1000" required="true" accept="image/*"/>
                    <img class="img-thumbnail" id="previewImage" alt="Imagen subida" src="" style="max-width: 300px; margin: 20px auto; border: 1px solid rgb(15,15,15);">
                    <div id="error" style="color: red"></div>

                    <button class="bg-black rounded-xl text-white py-2 hover:scale-105 duration-300" type="submit" >Crear Obra</button>
                </form>
            </div>
        </div>
    </section>

    <script>
        const fileInput = document.getElementById('foto');
        const previewImage = document.getElementById('previewImage');
        const errorMessage = document.getElementById('error');
        const maxSizeInMB = 20000; // Cambia el límite de tamaño aquí (en MB).

        fileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                // Verificar el tamaño del archivo
                if (file.size > maxSizeInMB * 1024 * 1024) {
                    errorMessage.textContent = `El archivo debe ser menor o
                igual a ${maxSizeInMB} MB.`;
                    previewImage.style.display = 'none';
                    fileInput.value = ''; // Limpiar la selección del archivo inválido
                    fileInput.disabled = false; // Habilitar el input nuevamente
                } else {
                    errorMessage.textContent = '';
                    const reader = new FileReader();

                    reader.onload = (e) => {
                        previewImage.src = e.target.result;
                        previewImage.style.display = 'block';
                    };

                    reader.readAsDataURL(file);
                }
            }
        });
    </script>
    <script th:src="@{/js/script.js}"></script>
</body>
</html>